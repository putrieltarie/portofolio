```{R}
library(readr)
Mall_Customers <- read_csv("D:/WORK/REMOTE/portofolio/R Project/data/Mall_Customers.csv")
head(Mall_Customers)
```

```{R}
# ubah file jadi customer_data
customer_data = as.data.frame(Mall_Customers)
head(customer_data)
```

```{R}
# ambil data tanpa kolom customer id
customer_copy = customer_data[,c(4,5)]
customer_copy = as.data.frame(customer_copy)
```

```{R}
# cek VIFs --> asumsi non multikol terpenuhi (VIF <10)
library(car) 
model <- lm(customer_data$Age ~ customer_data$`Annual Income (k$)`+customer_data$`Spending Score (1-100)`, data = customer_copy)
vif(model)
```

```{R}
# menentukan jumlah cluster dengan elbow method, diperoleh jumlah kluster = 5
library(factoextra)
library(cluster)
fviz_nbclust(customer_copy, kmeans, method = "wss")
```


```{R}
#perform k-means clustering with k = 5 clusters
km <- kmeans(customer_copy, centers = 5, nstart = 25)
km
```

```{R}
km <- kmeans(customer_copy, centers = 5, nstart = 25)
km
customer_copy$cluster = as.factor(km$cluster)

tabel_cluster = table(customer_copy$cluster)
tabel_cluster = as.data.frame(tabel_cluster)

tabel_cluster
colnames(tabel_cluster)[colnames(tabel_cluster) == "Var1"] <- "Cluster"
```